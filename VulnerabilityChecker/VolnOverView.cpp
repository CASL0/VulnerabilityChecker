// VolnOverView.cpp : 実装ファイル
//

#include "pch.h"
#include "VulnerabilityChecker.h"
#include "VolnOverView.h"
#include "afxdialogex.h"


// VolnOverView ダイアログ

IMPLEMENT_DYNAMIC(VolnOverView, CDialogEx)

VolnOverView::VolnOverView(CWnd* pParent /*=nullptr*/)
	: CDialogEx(IDD_VULN_OVERVIEW, pParent)
{

}

VolnOverView::~VolnOverView()
{
}

void VolnOverView::DoDataExchange(CDataExchange* pDX)
{
	CDialogEx::DoDataExchange(pDX);
	DDX_Control(pDX, IDC_LIST_VOLN_OVERVIEW, m_listVolnOverView);
}


BEGIN_MESSAGE_MAP(VolnOverView, CDialogEx)
END_MESSAGE_MAP()


// VolnOverView メッセージ ハンドラー
BOOL VolnOverView::OnInitDialog()
{
	(void)CDialogEx::OnInitDialog();

	EnableDynamicLayout(TRUE);
	(void)m_pDynamicLayout->Create(this);
	(void)m_pDynamicLayout->AddItem(IDC_LIST_VOLN_OVERVIEW, CMFCDynamicLayout::MoveNone(), CMFCDynamicLayout::SizeHorizontalAndVertical(100, 100));

	CString resourceStr;
	(void)resourceStr.LoadStringW(IDS_VOLN_OVERVIEW_LIST_TITLE);
	SetWindowText(resourceStr);

	(void)m_listVolnOverView.SetExtendedStyle(m_listVolnOverView.GetExtendedStyle() | LVS_EX_GRIDLINES | LVS_EX_HEADERDRAGDROP);
	(void)resourceStr.LoadStringW(IDS_VOLN_LIST_TITLE);
	(void)m_listVolnOverView.InsertColumn(0, resourceStr, LVCFMT_LEFT, 500);

	(void)resourceStr.LoadStringW(IDS_VOLN_LIST_ID);
	(void)m_listVolnOverView.InsertColumn(1, resourceStr, LVCFMT_LEFT, 200);

	(void)resourceStr.LoadStringW(IDS_VOLN_LIST_LINK);
	(void)m_listVolnOverView.InsertColumn(2, resourceStr, LVCFMT_LEFT, 300);

	CRect rect;
	GetWindowRect(&rect);
	(void)SetWindowPos(nullptr, rect.left, rect.top, 1000, rect.bottom - rect.top, SWP_SHOWWINDOW);

	return TRUE;  // フォーカスをコントロールに設定した場合を除き、TRUE を返します。
}
